//Package validator ...
package validator

import (
	"bytes"
	"fmt"
	"io/ioutil"
	"net/http"
	"testing"

	//m "github.com/Ulbora/GoAuth2/managers"
	gp "github.com/Ulbora/GoProxy"
	cp "github.com/Ulbora/JwtCompression"
)

func TestOauthClient_Validate(t *testing.T) {
	var vurl = "http://localhost:3000/rs/token/validate"
	var o OauthClient
	var proxy gp.MockGoProxy
	proxy.MockDoSuccess1 = true
	proxy.MockRespCode = 200
	var res http.Response
	res.Body = ioutil.NopCloser(bytes.NewBufferString(`{"valid":true}`))
	proxy.MockResp = &res

	//var proxy gp.GoProxy
	o.Proxy = proxy.GetNewProxy()

	var vr TokenRequest
	vr.AccessToken = "eNrUWctyqzgQ/aNbPExSLMcPsCgDw0uAdpZIbEA4rsvEIL5+SoRMMYtMBfmOcrOXRPfp06cfPDHnjG1S+qUDkgGoXglacAkNsgEPoL5mcOOYP56YE+QZbbFm1aC6PoKGDoTxA8UtyKBy3ILysHGGIgX8oQrblOJL+JzrDkU2fC1sesZ7l585F2nAz+yxYqmFfWKHxrvhCLSggSv+UTdOdH970tyKKC7rymNqKaB66b2YrPxtYrhxMDxHXVnY5k+UGslTtqageinz1KtQ5g2g7Mpc668oNZSIf6vadYeNcyGN9VpwpxqvPabwtbDMijSw5ueOqdUSxh13btiGMKnpAKorfmLOdvIlwlpPo2R8j/mbrkwas0UReAAXTyU2ZEEa/nVMV9zH9ztrbPe3QoM1hI4z3VXd+NSCerJhZ7XYNnWUhjCp69Ivwa1I+xLrzvmgO8NBm85tzAGlFsu10/x9JxzxWpuHfVsGk8+jXQndcczc6tQCyn1KOOZDka0pqa0ap/SV4/R+J0j7FusFRRaMoumutz0NH/nC8T7osM0bk+WRyQgzVaJBdtCsGm3AzL/Jjr3S/g9YKt4QLMdydo40NB4xKU2V2OG5sBN5+MZgtRzf/kr0QKKNO2OBjVPeBzds06GQyAN/+8t4cEa2RHy3RBXBF2lQmb894dA9R/3jPzhYo5ZN9o9cG/Hm7xIddihz1shWr7gEH2BHp7sJ86MP/OCxKk0V286NNLsbubg3MsZQMo4x6H5/HIOVtwDH9xp24N+wLQVFMnWVfD6fdDigDNyIBs+k8V4k8nJwN4t5eUGZVF72IrzM07CWystShJcezTOnOkqt90K9U43Snsqt7e6SuDOOz0ELKbahzDxX3Uqgbr7x7ovq5Un/BvmkL6mXReZxHOXq0vbUfY++7rS4DhXZus6zkMrUT3d5vL9Ak3bK8pjPzmXONRlx+QqMEybUO8nXVMXfgu+lqfFOE9GCL+GAQJ8yO8eO8C2WQnuKaMaJ5rPY/iFQr8L9uKuyQoPYiZjmitnai/Fg1DPB/VQ95+35k3pruGw5D0LdOeNLOO4LJcZ/JRD/CKXhlTSwKjhnI7M9Zt7SOdWY51n+2X5QRLv+tUep5fF1Wyu/AFsBrRXhbNL50Z3aFYn2DGL2iuTYnT2YCGcVP04EOFuwPDUUuKcdkotrv2Rnkc+/C2XyNTDEdgJv8RfYq4npVby7W68EZkMhnnpDvmCWGeMlU0tF52ruu8R4C/XWFNmUodRT+AwjPBOI1X+hGnXXPkgs/t0dvZ9E/QwMf3N3HRXYtYjVUJGZdab1svo+xY9rwZlVqkb14rkkrd/X7t2xCP/vEbP3nryX1ou45V159J/6lGXKj6Py56OB1IfydDmktY7XfeOTCjvwiFzXQIReftZeq65ersnfAQAA//+f/SmI"
	//vr.UserID = "userID"
	vr.ClientID = 10
	vr.Role = "superAdmin"
	vr.URI = "/ulbora/rs/client/update"
	//vr.Scope = "read"

	valid := o.validateAccessToken(&vr, vurl)
	if !valid {
		t.Fail()
	}
}

func TestOauthClient_Authorize(t *testing.T) {

	var oc OauthClient
	var vurl = "http://localhost:3000/rs/token/validate"

	var proxy gp.MockGoProxy
	proxy.MockDoSuccess1 = true
	proxy.MockRespCode = 200
	var res http.Response
	res.Body = ioutil.NopCloser(bytes.NewBufferString(`{"valid":true}`))
	proxy.MockResp = &res

	//var proxy gp.GoProxy
	oc.Proxy = proxy.GetNewProxy()

	var cl Claim
	cl.Role = "superAdmin"
	cl.URL = "/ulbora/rs/client/update"
	//cl.Scope = "web"
	var token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJQYXlsb2FkIjp7ImlzcyI6IkdvQXV0aDIiLCJzdWIiOiJjbGllbnRfY3JlZGVudGlhbHMiLCJhdWQiOiJHb0F1dGgyLmNvbSIsImV4cCI6MTU3ODg2MzU0OSwiaWF0IjoxNTc4ODU5OTQ5fSwidG9rZW5UeXBlIjoiYWNjZXNzIiwiY2xpZW50SWQiOjEwLCJncmFudCI6ImNsaWVudF9jcmVkZW50aWFscyIsInJvbGVVUklzIjpbeyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE1MTgsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudC9zZWFyY2giLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDgzLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy91c2VyL2FkZCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0NzQsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudEFsbG93ZWRVcmlTdXBlci91cGRhdGUiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTI4LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy91c2VyL2xpc3QiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTE5LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvbGlzdCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0ODQsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudEFsbG93ZWRVcmlTdXBlci9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDc1LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvZ2V0IiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUyOSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvcm9sZS9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTIwLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvZ2V0IiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ4NSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50L3VwZGF0ZSIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0NzcsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL3VzZXIvc2VhcmNoIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUzMCwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvcm9sZS9nZXQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTIxLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvYWRkIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ4NiwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50L3NlYXJjaCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0NzgsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudC9kZWxldGUiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTMxLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9yb2xlL2RlbGV0ZSIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE1MjQsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudFJvbGVTdXBlci9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDg3LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvYWRkIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ3OSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvdXNlci9nZXQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDgwLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvbGlzdCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0ODgsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL3VzZXIvdXBkYXRlIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ4MSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvdXNlci9kZWxldGUiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTE0LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRBbGxvd2VkVXJpU3VwZXIvdXBkYXRlIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUyNSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50L2RlbGV0ZSIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOCwiUm9sZSI6InN1cGVyQWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0ODIsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudFJvbGVTdXBlci9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjgsIlJvbGUiOiJzdXBlckFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTE2LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvdXBkYXRlIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI4LCJSb2xlIjoic3VwZXJBZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUyNiwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50QWxsb3dlZFVyaVN1cGVyL2FkZCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTA3LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRHcmFudFR5cGUvbGlzdCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTAxLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvdXNlci9zZWFyY2giLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ5MywiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50R3JhbnRUeXBlL2FkZCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTA4LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRSZWRpcmVjdFVyaS9saXN0IiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI5LCJSb2xlIjoiYWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE1MDIsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudEFsbG93ZWRVcmkvbGlzdCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDk0LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRSZWRpcmVjdFVyaS9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUwOSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50QWxsb3dlZFVyaS9kZWxldGUiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUwMywiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50L3VzZXIvdXBkYXRlIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI5LCJSb2xlIjoiYWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0OTUsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudEdyYW50VHlwZS9kZWxldGUiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUxMCwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50Um9sZVVyaS9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ5NiwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50L3VzZXIvZ2V0IiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI5LCJSb2xlIjoiYWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE1MTEsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudEFsbG93ZWRVcmkvYWRkIiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI5LCJSb2xlIjoiYWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0NzYsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL3JvbGUvbGlzdCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDk3LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvYWRtaW4vZ2V0IiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI5LCJSb2xlIjoiYWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE1MTIsIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudFJlZGlyZWN0VXJpL2RlbGV0ZSIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTA0LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRSb2xlL2RlbGV0ZSIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDkwLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvdXNlci9kZWxldGUiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ5OCwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50QWxsb3dlZFVyaS9nZXQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTUwNSwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50Um9sZVVyaS9saXN0IiwiQ2xpZW50SUQiOjEwfSx7IkNsaWVudFJvbGVJRCI6MTI5LCJSb2xlIjoiYWRtaW4iLCJDbGllbnRBbGxvd2VkVVJJSUQiOjE0OTksIkNsaWVudEFsbG93ZWRVUkkiOiIvdWxib3JhL3JzL2NsaWVudFJvbGUvbGlzdCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNDkxLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRSb2xlL2FkZCIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTA2LCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnRBbGxvd2VkVXJpL3VwZGF0ZSIsIkNsaWVudElEIjoxMH0seyJDbGllbnRSb2xlSUQiOjEyOSwiUm9sZSI6ImFkbWluIiwiQ2xpZW50QWxsb3dlZFVSSUlEIjoxNTAwLCJDbGllbnRBbGxvd2VkVVJJIjoiL3VsYm9yYS9ycy9jbGllbnQvdXNlci9hZGQiLCJDbGllbnRJRCI6MTB9LHsiQ2xpZW50Um9sZUlEIjoxMjksIlJvbGUiOiJhZG1pbiIsIkNsaWVudEFsbG93ZWRVUklJRCI6MTQ5MiwiQ2xpZW50QWxsb3dlZFVSSSI6Ii91bGJvcmEvcnMvY2xpZW50Um9sZVVyaS9kZWxldGUiLCJDbGllbnRJRCI6MTB9XX0.YKaDr007I3EoltesHT1DT80_unIHrZFH8kLL1KznHy4"
	fmt.Println("len of token: ", len(token))
	var jc cp.JwtCompress
	tkn := jc.CompressJwt(token)
	fmt.Println("tkn", tkn)
	fmt.Println("len of compressed token: ", len(tkn))
	r, _ := http.NewRequest("GET", "/testurl", nil)
	r.Header.Set("Authorization", "Bearer "+tkn)
	r.Header.Set("clientId", "10")
	//r.Header.Set("userId", "lfo")

	suc := oc.Authorize(r, &cl, vurl)
	fmt.Println("suc auth", suc)
	if !suc {
		t.Fail()
	}
}

func TestOauthClient_GetNewProxy(t *testing.T) {
	var oc OauthClient
	c := oc.GetNewClient()
	if c == nil {
		t.Fail()
	}
}
